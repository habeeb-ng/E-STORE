{"ast":null,"code":"import { collection, doc, getDoc, increment, orderBy, query, serverTimestamp, setDoc, updateDoc } from \"firebase/firestore\";\nimport { Link, Navigate, useNavigate } from 'react-router-dom';\nimport Product from './Product';\nimport './Home.css';\nimport { useDispatch, useSelector } from \"react-redux\";\nimport { auth, db } from './backend/firebase';\nimport { defaultCartState, firstCall, updateCart } from \"./features/cartSlice\";\n\nconst handleAddToCart = (thisProduct, user, dispatch, navigate) => {\n  if (user) {\n    const cartColRef = collection(db, \"Users\", user.userId, \"userCart\");\n    const createColRef = doc(db, \"Users\", user.userId, \"userCart\", `${thisProduct.id}`);\n    const q = query(cartColRef, orderBy(\"timestamp\", \"desc\"));\n    getDoc(createColRef).then(doc => {\n      if (doc.exists()) {\n        console.log(doc);\n        updateDoc(createColRef, {\n          quantity: increment(1),\n          productTotal: increment(thisProduct.price)\n        });\n      } else {\n        setDoc(createColRef, { ...thisProduct,\n          timestamp: serverTimestamp(),\n          quantity: 1,\n          productTotal: thisProduct.price\n        }).catch(err => {\n          console.log(err);\n        });\n      }\n    }).then(doc => {\n      console.log(doc.data());\n    }); // else if (!createColRef) {\n    // }\n  } else {\n    navigate('/signIn');\n  }\n};\n\nexport default handleAddToCart;","map":{"version":3,"names":["collection","doc","getDoc","increment","orderBy","query","serverTimestamp","setDoc","updateDoc","Link","Navigate","useNavigate","Product","useDispatch","useSelector","auth","db","defaultCartState","firstCall","updateCart","handleAddToCart","thisProduct","user","dispatch","navigate","cartColRef","userId","createColRef","id","q","then","exists","console","log","quantity","productTotal","price","timestamp","catch","err","data"],"sources":["/Users/habeebawolumate/Documents/Builds/e-commerce/src/handleAddToCart.js"],"sourcesContent":["import {\n    collection,\n    doc,\n    getDoc,\n    increment,\n    orderBy,\n    query,\n    serverTimestamp,\n    setDoc,\n    updateDoc\n} from \"firebase/firestore\";\nimport { Link, Navigate, useNavigate } from 'react-router-dom';\nimport Product from './Product';\nimport './Home.css'\nimport { useDispatch, useSelector } from \"react-redux\";\nimport { auth, db } from './backend/firebase';\nimport { defaultCartState, firstCall, updateCart } from \"./features/cartSlice\"\n\nconst handleAddToCart = (thisProduct, user, dispatch, navigate) => {\n    \n    \n    if (user) {\n      const cartColRef = collection(db, \"Users\", user.userId, \"userCart\");\n      const createColRef = doc(db, \"Users\", user.userId, \"userCart\", `${thisProduct.id}`);\n      const q = query(cartColRef, orderBy(\"timestamp\", \"desc\"));\n      getDoc(createColRef)\n        .then((doc) => {\n          if (doc.exists()) {\n            console.log(doc)\n            updateDoc(createColRef, {\n              quantity: increment(1),\n              productTotal: increment(thisProduct.price)\n            })\n          } else{\n            setDoc(createColRef, {\n              ...thisProduct,\n              timestamp: serverTimestamp(),\n              quantity: 1,\n              productTotal: thisProduct.price\n            })\n            .catch((err)=>{\n              console.log(err)\n            })\n          }\n        \n        })\n        .then((doc) => {\n          console.log(doc.data())\n        });\n      \n        \n              // else if (!createColRef) {\n\n        \n      // }\n      \n\n      \n    } else {\n      navigate('/signIn');\n    }\n    \n}\nexport default handleAddToCart;"],"mappings":"AAAA,SACIA,UADJ,EAEIC,GAFJ,EAGIC,MAHJ,EAIIC,SAJJ,EAKIC,OALJ,EAMIC,KANJ,EAOIC,eAPJ,EAQIC,MARJ,EASIC,SATJ,QAUO,oBAVP;AAWA,SAASC,IAAT,EAAeC,QAAf,EAAyBC,WAAzB,QAA4C,kBAA5C;AACA,OAAOC,OAAP,MAAoB,WAApB;AACA,OAAO,YAAP;AACA,SAASC,WAAT,EAAsBC,WAAtB,QAAyC,aAAzC;AACA,SAASC,IAAT,EAAeC,EAAf,QAAyB,oBAAzB;AACA,SAASC,gBAAT,EAA2BC,SAA3B,EAAsCC,UAAtC,QAAwD,sBAAxD;;AAEA,MAAMC,eAAe,GAAG,CAACC,WAAD,EAAcC,IAAd,EAAoBC,QAApB,EAA8BC,QAA9B,KAA2C;EAG/D,IAAIF,IAAJ,EAAU;IACR,MAAMG,UAAU,GAAGzB,UAAU,CAACgB,EAAD,EAAK,OAAL,EAAcM,IAAI,CAACI,MAAnB,EAA2B,UAA3B,CAA7B;IACA,MAAMC,YAAY,GAAG1B,GAAG,CAACe,EAAD,EAAK,OAAL,EAAcM,IAAI,CAACI,MAAnB,EAA2B,UAA3B,EAAwC,GAAEL,WAAW,CAACO,EAAG,EAAzD,CAAxB;IACA,MAAMC,CAAC,GAAGxB,KAAK,CAACoB,UAAD,EAAarB,OAAO,CAAC,WAAD,EAAc,MAAd,CAApB,CAAf;IACAF,MAAM,CAACyB,YAAD,CAAN,CACGG,IADH,CACS7B,GAAD,IAAS;MACb,IAAIA,GAAG,CAAC8B,MAAJ,EAAJ,EAAkB;QAChBC,OAAO,CAACC,GAAR,CAAYhC,GAAZ;QACAO,SAAS,CAACmB,YAAD,EAAe;UACtBO,QAAQ,EAAE/B,SAAS,CAAC,CAAD,CADG;UAEtBgC,YAAY,EAAEhC,SAAS,CAACkB,WAAW,CAACe,KAAb;QAFD,CAAf,CAAT;MAID,CAND,MAMM;QACJ7B,MAAM,CAACoB,YAAD,EAAe,EACnB,GAAGN,WADgB;UAEnBgB,SAAS,EAAE/B,eAAe,EAFP;UAGnB4B,QAAQ,EAAE,CAHS;UAInBC,YAAY,EAAEd,WAAW,CAACe;QAJP,CAAf,CAAN,CAMCE,KAND,CAMQC,GAAD,IAAO;UACZP,OAAO,CAACC,GAAR,CAAYM,GAAZ;QACD,CARD;MASD;IAEF,CApBH,EAqBGT,IArBH,CAqBS7B,GAAD,IAAS;MACb+B,OAAO,CAACC,GAAR,CAAYhC,GAAG,CAACuC,IAAJ,EAAZ;IACD,CAvBH,EAJQ,CA8BA;IAGR;EAID,CArCD,MAqCO;IACLhB,QAAQ,CAAC,SAAD,CAAR;EACD;AAEJ,CA5CD;;AA6CA,eAAeJ,eAAf"},"metadata":{},"sourceType":"module"}