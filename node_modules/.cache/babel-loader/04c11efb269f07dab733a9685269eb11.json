{"ast":null,"code":"var _s = $RefreshSig$();\n\nimport { collection, doc, getDoc, increment, orderBy, query, serverTimestamp, setDoc, updateDoc } from \"firebase/firestore\";\nimport { Link, Navigate, useNavigate } from 'react-router-dom';\nimport Product from './Product';\nimport './Home.css';\nimport { useDispatch, useSelector } from \"react-redux\";\nimport { auth, db } from './backend/firebase';\nimport { defaultCartState, firstCall, updateCart } from \"./features/cartSlice\";\n\nconst handleAddToCart = (thisProduct, dispatch, navigate) => {\n  _s();\n\n  const user = useSelector(state => state.user.user);\n\n  if (user) {\n    const cartColRef = collection(db, \"Users\", user.userId, \"userCart\");\n    const createColRef = doc(db, \"Users\", user.userId, \"userCart\", `${thisProduct.id}`);\n    const q = query(cartColRef, orderBy(\"timestamp\", \"desc\"));\n    getDoc(createColRef).then(doc => {\n      if (doc.exists()) {\n        updateDoc(createColRef, {\n          quantity: increment(1),\n          productTotal: increment(thisProduct.price)\n        });\n      } else {\n        setDoc(createColRef, { ...thisProduct,\n          timestamp: serverTimestamp(),\n          quantity: 1,\n          productTotal: thisProduct.price\n        }).catch(err => {\n          console.log(err);\n        });\n      }\n    }); // else if (!createColRef) {\n    // }\n  } else {\n    navigate('/signIn');\n  }\n};\n\n_s(handleAddToCart, \"ODc3cjw/vvoWaLFqHWcEGODyOfo=\", false, function () {\n  return [useSelector];\n});\n\nexport default handleAddToCart;","map":{"version":3,"names":["collection","doc","getDoc","increment","orderBy","query","serverTimestamp","setDoc","updateDoc","Link","Navigate","useNavigate","Product","useDispatch","useSelector","auth","db","defaultCartState","firstCall","updateCart","handleAddToCart","thisProduct","dispatch","navigate","user","state","cartColRef","userId","createColRef","id","q","then","exists","quantity","productTotal","price","timestamp","catch","err","console","log"],"sources":["/Users/habeebawolumate/Documents/Builds/e-commerce/src/handleAddToCart.js"],"sourcesContent":["import {\n    collection,\n    doc,\n    getDoc,\n    increment,\n    orderBy,\n    query,\n    serverTimestamp,\n    setDoc,\n    updateDoc\n} from \"firebase/firestore\";\nimport { Link, Navigate, useNavigate } from 'react-router-dom';\nimport Product from './Product';\nimport './Home.css'\nimport { useDispatch, useSelector } from \"react-redux\";\nimport { auth, db } from './backend/firebase';\nimport { defaultCartState, firstCall, updateCart } from \"./features/cartSlice\"\n\nconst handleAddToCart = (thisProduct, dispatch, navigate) => {\n    const user = useSelector(state=> state.user.user)\n    \n    if (user) {\n      const cartColRef = collection(db, \"Users\", user.userId, \"userCart\");\n      const createColRef = doc(db, \"Users\", user.userId, \"userCart\", `${thisProduct.id}`);\n      const q = query(cartColRef, orderBy(\"timestamp\", \"desc\"));\n      getDoc(createColRef)\n        .then((doc) => {\n          if (doc.exists()) {\n            updateDoc(createColRef, {\n              quantity: increment(1),\n              productTotal: increment(thisProduct.price)\n            })\n        } else{\n        setDoc(createColRef, {\n          ...thisProduct,\n          timestamp: serverTimestamp(),\n          quantity: 1,\n          productTotal: thisProduct.price\n        })\n        .catch((err)=>{\n          console.log(err)\n        })\n        }\n        \n      });\n      \n        \n              // else if (!createColRef) {\n\n        \n      // }\n      \n\n      \n    } else {\n      navigate('/signIn');\n    }\n    \n}\nexport default handleAddToCart;"],"mappings":";;AAAA,SACIA,UADJ,EAEIC,GAFJ,EAGIC,MAHJ,EAIIC,SAJJ,EAKIC,OALJ,EAMIC,KANJ,EAOIC,eAPJ,EAQIC,MARJ,EASIC,SATJ,QAUO,oBAVP;AAWA,SAASC,IAAT,EAAeC,QAAf,EAAyBC,WAAzB,QAA4C,kBAA5C;AACA,OAAOC,OAAP,MAAoB,WAApB;AACA,OAAO,YAAP;AACA,SAASC,WAAT,EAAsBC,WAAtB,QAAyC,aAAzC;AACA,SAASC,IAAT,EAAeC,EAAf,QAAyB,oBAAzB;AACA,SAASC,gBAAT,EAA2BC,SAA3B,EAAsCC,UAAtC,QAAwD,sBAAxD;;AAEA,MAAMC,eAAe,GAAG,CAACC,WAAD,EAAcC,QAAd,EAAwBC,QAAxB,KAAqC;EAAA;;EACzD,MAAMC,IAAI,GAAGV,WAAW,CAACW,KAAK,IAAGA,KAAK,CAACD,IAAN,CAAWA,IAApB,CAAxB;;EAEA,IAAIA,IAAJ,EAAU;IACR,MAAME,UAAU,GAAG1B,UAAU,CAACgB,EAAD,EAAK,OAAL,EAAcQ,IAAI,CAACG,MAAnB,EAA2B,UAA3B,CAA7B;IACA,MAAMC,YAAY,GAAG3B,GAAG,CAACe,EAAD,EAAK,OAAL,EAAcQ,IAAI,CAACG,MAAnB,EAA2B,UAA3B,EAAwC,GAAEN,WAAW,CAACQ,EAAG,EAAzD,CAAxB;IACA,MAAMC,CAAC,GAAGzB,KAAK,CAACqB,UAAD,EAAatB,OAAO,CAAC,WAAD,EAAc,MAAd,CAApB,CAAf;IACAF,MAAM,CAAC0B,YAAD,CAAN,CACGG,IADH,CACS9B,GAAD,IAAS;MACb,IAAIA,GAAG,CAAC+B,MAAJ,EAAJ,EAAkB;QAChBxB,SAAS,CAACoB,YAAD,EAAe;UACtBK,QAAQ,EAAE9B,SAAS,CAAC,CAAD,CADG;UAEtB+B,YAAY,EAAE/B,SAAS,CAACkB,WAAW,CAACc,KAAb;QAFD,CAAf,CAAT;MAIH,CALC,MAKI;QACN5B,MAAM,CAACqB,YAAD,EAAe,EACnB,GAAGP,WADgB;UAEnBe,SAAS,EAAE9B,eAAe,EAFP;UAGnB2B,QAAQ,EAAE,CAHS;UAInBC,YAAY,EAAEb,WAAW,CAACc;QAJP,CAAf,CAAN,CAMCE,KAND,CAMQC,GAAD,IAAO;UACZC,OAAO,CAACC,GAAR,CAAYF,GAAZ;QACD,CARD;MASC;IAEF,CAnBD,EAJQ,CA0BA;IAGR;EAID,CAjCD,MAiCO;IACLf,QAAQ,CAAC,SAAD,CAAR;EACD;AAEJ,CAxCD;;GAAMH,e;UACWN,W;;;AAwCjB,eAAeM,eAAf"},"metadata":{},"sourceType":"module"}